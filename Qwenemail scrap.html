<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Scraper with AI Analysis</title>
    <script src="https://cdn.tailwindcss.com "></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            background-image: radial-gradient(#334155 1px, transparent 1px);
            background-size: 2rem 2rem;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }
    </style>
    <script>
        localStorage.theme = 'dark'
    </script>
</head>
<body class="text-slate-300 antialiased">

<!-- Header -->
<header class="bg-slate-900/70 backdrop-blur-sm shadow-sm sticky top-0 z-10 border-b border-slate-800">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
            <h1 class="text-xl sm:text-2xl font-bold text-white flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 10l.01.01" />
                </svg>
                <span>Web Data Extractor</span>
            </h1>
        </div>
    </div>
</header>

<!-- Hero Section -->
<section class="text-center py-12 px-4">
    <h1 class="text-3xl md:text-4xl font-bold text-white">Web Scraper with AI Analysis</h1>
    <p class="mt-4 text-slate-300 max-w-xl mx-auto">
        Enter URLs below and extract emails, phone numbers, locations, and more.
    </p>
</section>

<!-- Pricing Plans Section -->
<section class="px-4 pb-12">
    <div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-6">
        <!-- Starter Plan -->
        <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow duration-300">
            <h2 class="text-xl font-semibold text-white mb-2">Starter</h2>
            <ul class="text-sm text-slate-400 space-y-2 mb-6">
                <li>✔️ Up to 5 URLs</li>
                <li>✔️ Basic contact extraction</li>
                <li>✔️ CSV export</li>
            </ul>
            <button class="w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-md font-medium transition">
                Free Tier
            </button>
        </div>

        <!-- Pro Plan -->
        <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow duration-300">
            <h2 class="text-xl font-semibold text-white mb-2">Pro</h2>
            <ul class="text-sm text-slate-400 space-y-2 mb-6">
                <li>✔️ Up to 50 URLs</li>
                <li>✔️ Advanced contact extraction</li>
                <li>✔️ AI Profile Generation</li>
                <li>✔️ Priority Support</li>
            </ul>
            <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-md font-medium transition">
                $19/month
            </button>
        </div>

        <!-- Advanced Plan -->
        <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow duration-300">
            <h2 class="text-xl font-semibold text-white mb-2">Advanced</h2>
            <ul class="text-sm text-slate-400 space-y-2 mb-6">
                <li>✔️ Unlimited URLs</li>
                <li>✔️ Full API access</li>
                <li>✔️ Custom integrations</li>
                <li>✔️ Dedicated support</li>
            </ul>
            <button class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-md font-medium transition">
                Contact Sales
            </button>
        </div>
    </div>
</section>

<!-- Input Form Section -->
<section class="px-4 pb-12">
    <div class="max-w-6xl mx-auto">
        <textarea id="websites" rows="6"
            class="w-full p-4 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-300 focus:outline-none focus:ring-2 focus:ring-green-500"
            placeholder=" https://example.com &#10;anotherexample.org"></textarea>
        <div class="flex gap-3 mt-4">
            <button id="extractBtn" class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md shadow hover:shadow-lg transition">
                Extract Information
            </button>
            <button id="exportBtn" class="hidden flex items-center gap-2 bg-slate-700 hover:bg-slate-600 text-slate-300 font-bold py-2 px-4 rounded-md shadow hover:shadow-lg transition">
                Export to CSV
            </button>
        </div>
    </div>
</section>

<!-- Results Section -->
<section class="px-4 pb-12">
    <div class="max-w-6xl mx-auto">
        <div id="empty-state" class="text-center p-8 bg-slate-800 rounded-lg border border-dashed border-slate-700">
            <svg class="mx-auto h-12 w-12 text-slate-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607zM10.5 7.5v6m3-3h-6" />
            </svg>
            <h3 class="mt-4 text-xl font-semibold text-white">Ready to find some data?</h3>
            <p class="mt-2 text-slate-400">Paste your URLs above and click "Extract" to begin.</p>
        </div>
        <div id="results" class="space-y-6 mt-6"></div>
    </div>
</section>

<!-- Footer -->
<footer class="text-center py-6 text-slate-500 text-sm">
    &copy; 2025 Web Scraper with AI. All rights reserved.
</footer>

<script>
    // --- DOM Element References ---
    const websitesTextarea = document.getElementById('websites');
    const extractBtn = document.getElementById('extractBtn');
    const exportBtn = document.getElementById('exportBtn');
    const btnText = document.getElementById('btnText');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const resultsDiv = document.getElementById('results');
    const emptyStateDiv = document.getElementById('empty-state');

    // --- Global State ---
    let allResultsData = [];

    // --- Event Listeners ---
    extractBtn.addEventListener('click', handleExtraction);
    exportBtn.addEventListener('click', handleExport);

    /**
     * Main function to handle the extraction process when the button is clicked.
     */
    async function handleExtraction() {
        const lines = websitesTextarea.value.trim().split('\n');
        const urlLikePattern = /.+?\..+/;
        const urls = lines.filter(line => urlLikePattern.test(line.trim()));

        if (urls.length === 0) {
            displayMessage('No valid website URLs found.', 'red');
            return;
        }

        clearResults();
        allResultsData = [];
        exportBtn.classList.add('hidden');
        emptyStateDiv.classList.add('hidden');
        toggleLoading(true);

        await Promise.all(urls.map(url => processUrl(url)));

        toggleLoading(false);

        if (resultsDiv.innerHTML.trim() === '') {
            displayMessage('No emails or phone numbers found on the valid websites provided.', 'yellow');
            emptyStateDiv.classList.remove('hidden');
        }
    }

    /**
     * Processes a single URL: fetches its content and extracts information.
     */
    async function processUrl(url) {
        const fullUrl = url.trim().startsWith('http://') || url.trim().startsWith('https://') ? url.trim() : `https://${url.trim()}`;
        const proxyUrl = `https://cors.eu.org/ ${fullUrl}`;
        let resultData = { url: fullUrl, name: '', textContent: '', emails: [], phoneNumbers: [], whatsappNumbers: [], locations: [], error: null };

        try {
            const response = await fetch(proxyUrl);
            if (!response.ok) throw new Error(`Failed to fetch content.`);
            const htmlContent = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');

            resultData.name = extractName(doc);
            resultData.textContent = doc.body.textContent.substring(0, 30000);
            resultData.emails = extractEmails(htmlContent, doc);
            const { phoneNumbers, whatsappNumbers } = extractPhoneNumbers(htmlContent, doc);
            resultData.phoneNumbers = phoneNumbers;
            resultData.whatsappNumbers = whatsappNumbers;
            resultData.locations = extractLocations(doc);
        } catch (error) {
            console.error(`Error processing ${url}:`, error);
            resultData.error = error instanceof Error ? error.message : String(error);
        }

        allResultsData.push(resultData);
        displayResult(resultData);

        if (allResultsData.length > 0) {
            exportBtn.classList.remove('hidden');
        }
    }

    function extractName(doc) {
        const title = doc.querySelector('title');
        return title ? title.textContent.split(/\||–|-/)[0].trim() : '';
    }

    function extractEmails(html, doc) {
        const emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
        let foundEmails = [...new Set([
            ...Array.from(doc.querySelectorAll('a[href^="mailto:"]')).map(link => link.getAttribute('href').replace('mailto:', '')),
            ...(html.match(emailRegex) || []),
            ...(doc.documentElement.textContent.match(emailRegex) || [])
        ])];
        return foundEmails;
    }

    function extractPhoneNumbers(html, doc) {
        const phoneRegex = /(?:(?:\+966|00966)[\s-.]?\d{9}|9200[\s-.]?\d{5})/g;
        const uniqueNormalizedNumbers = new Set();
        const phoneNumbers = [];
        const whatsappNumbers = [];

        Array.from(doc.querySelectorAll('a')).forEach(link => {
            const href = link.getAttribute('href');
            if (!href) return;

            let number = '';
            let isWhatsapp = false;

            if (href.includes('wa.me/') || href.includes('whatsapp.com')) {
                const digits = href.match(/\d+/g);
                if (digits) { number = digits.join(''); isWhatsapp = true; }
            } else if (href.startsWith('tel:')) {
                number = href.replace('tel:', '');
            }

            if (number) {
                const normalized = normalizeNumber(number);
                if (!uniqueNormalizedNumbers.has(normalized)) {
                    if (isWhatsapp) whatsappNumbers.push(number);
                    else phoneNumbers.push(number);
                    uniqueNormalizedNumbers.add(normalized);
                }
            }
        });

        const searchCorpus = html + ' ' + doc.documentElement.textContent;
        const matches = searchCorpus.match(phoneRegex) || [];
        matches.forEach(num => {
            const normalized = normalizeNumber(num);
            if (!uniqueNormalizedNumbers.has(normalized)) {
                phoneNumbers.push(num);
                uniqueNormalizedNumbers.add(normalized);
            }
        });

        return { phoneNumbers, whatsappNumbers };
    }

    function normalizeNumber(numberStr) {
        let n = numberStr.trim().replace(/[^\d]/g, '');
        if (n.startsWith('00')) n = `+${n.substring(2)}`;
        if (!n.startsWith('+')) {
            if (n.startsWith('966')) n = `+${n}`;
            else n = `+966${n.replace(/^0/, '')}`;
        }
        return n;
    }

    function extractLocations(doc) {
        const cities = ['Riyadh', 'Jeddah', 'Mecca', 'Medina', 'Dammam', 'Khobar', 'Dhahran', 'Taif', 'Tabuk', 'Buraidah', 'Khamis Mushait', 'Abha'];
        const foundLocations = new Set();
        const textContent = doc.documentElement.textContent;

        cities.forEach(city => {
            const regex = new RegExp(`\\b${city}\\b`, 'gi');
            if (regex.test(textContent)) foundLocations.add(city);
        });

        return [...foundLocations];
    }

    async function getAiProfile(text, contacts, buttonEl) {
        buttonEl.disabled = true;
        const spinner = buttonEl.querySelector('.ai-spinner');
        const btnText = buttonEl.querySelector('span');
        spinner.classList.remove('hidden');
        btnText.textContent = 'Generating...';

        const apiKey = ""; // Replace with actual Gemini API key
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash :generateContent?key=${apiKey}`;
        const prompt = `Based on the following website text and contact list, generate a JSON object with a one-sentence summary of the company, its primary industry, and suggest the most likely primary contact. Website text: "${text}". Available contacts: "${contacts.join(', ')}".`;

        const payload = {
            contents: [{ parts: [{ text: prompt }] }],
            generationConfig: {
                responseMimeType: "application/json",
                responseSchema: {
                    type: "OBJECT",
                    properties: {
                        "summary": { "type": "STRING" },
                        "industry": { "type": "STRING" },
                        "primary_contact": { "type": "STRING" }
                    },
                    required: ["summary", "industry", "primary_contact"]
                }
            }
        };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) throw new Error(`API Error`);

            const result = await response.json();
            const profileData = JSON.parse(result.candidates[0].content.parts[0].text);

            const profileContainer = buttonEl.closest('.result-card').querySelector('.ai-profile-container');
            profileContainer.innerHTML = `
                <div class="mt-4 border-t border-slate-700 pt-4">
                    <h4 class="text-sm font-medium text-slate-400 mb-2 flex items-center gap-2">
                        <svg class="h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>
                        AI Generated Profile
                    </h4>
                    <p class="text-sm text-slate-300"><strong class="font-semibold text-slate-400">Summary:</strong> ${profileData.summary}</p>
                    <p class="text-sm text-slate-300 mt-1"><strong class="font-semibold text-slate-400">Industry:</strong> ${profileData.industry}</p>
                    <p class="text-sm text-slate-300 mt-1"><strong class="font-semibold text-slate-400">Suggested Contact:</strong> ${profileData.primary_contact}</p>
                </div>
            `;
            buttonEl.remove();
        } catch (error) {
            console.error("Gemini API error:", error);
            btnText.textContent = 'Error';
            buttonEl.classList.remove('bg-purple-600', 'hover:bg-purple-700');
            buttonEl.classList.add('bg-red-600');
            displayMessage('Failed to generate AI profile.', 'red');
        }
    }

    function displayResult(resultData) {
        const { url, name, textContent, emails, phoneNumbers, whatsappNumbers, locations, error } = resultData;
        const resultCard = document.createElement('div');
        resultCard.className = 'bg-slate-800 border border-slate-700 p-6 rounded-xl shadow-lg transition-transform transform hover:scale-[1.01] result-card';
        const hasData = emails.length > 0 || phoneNumbers.length > 0 || whatsappNumbers.length > 0 || locations.length > 0;

        let cardHeader = `
            <div class="flex items-start justify-between">
                <div>
                    <h2 class="text-xl font-bold text-white mb-1">${name || 'Name not found'}</h2>
                    <a href="${url}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-400 hover:underline break-all">${url}</a>
                </div>
                ${error ? `<div class="flex-shrink-0 ml-4"><svg class="h-6 w-6 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" /></svg></div>` : ''}
            </div>`;

        let cardBody = '';

        if (error) {
            cardBody = `<p class="text-red-400 mt-4 text-sm">Error: ${error}</p>`;
        } else if (!hasData) {
            cardBody = `<p class="text-slate-400 mt-4 text-sm">No contact information or locations found.</p>`;
        } else {
            const createSection = (title, items, icon, colorClass = 'text-slate-400') => {
                if (items.length === 0) return '';
                return `
                    <div class="flex items-start">
                        <div class="flex-shrink-0 w-6 text-center">
                            <svg class="h-5 w-5 ${colorClass}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">${icon}</svg>
                        </div>
                        <div class="ml-4 flex-1">
                            <h4 class="text-sm font-medium text-slate-400">${title}</h4>
                            <ul class="mt-1 space-y-1 text-sm text-slate-300">${items.map(item => `<li>${item}</li>`).join('')}</ul>
                        </div>
                    </div>`;
            };

            const mailIcon = `<path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />`;
            const phoneIcon = `<path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 6.75z" />`;
            const whatsappIcon = `<path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m3.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M9 12.75h6m-6 3h6m-6-3h.008v.008H9v-.008zm-3 0h.008v.008H6v-.008zm-3 0h.008v.008H3v-.008zM7.5 6.375c0-1.036.84-1.875 1.875-1.875h.375m10.125 0h.375c1.036 0 1.875.84 1.875 1.875v.375m0 10.125v.375c0 1.035-.84 1.875-1.875 1.875h-.375m-10.125 0h-.375c-1.036 0-1.875-.84-1.875-1.875v-.375m0-10.125v-.375c0-1.036.84-1.875 1.875-1.875h.375" />`;
            const locationIcon = `<path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />`;

            const aiButton = `
                <div class="mt-6">
                    <button class="ai-profile-btn w-full flex justify-center items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out text-sm">
                        <svg class="h-5 w-5 ai-sparkle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>
                        <span>✨ Generate Profile</span>
                        <span class="ai-spinner hidden animate-spin rounded-full h-4 w-4 border-b-2 border-white"></span>
                    </button>
                </div>`;

            cardBody = `
                <div class="mt-6 border-t border-slate-700 pt-6 space-y-5">
                    ${createSection('Emails', emails, mailIcon, 'text-blue-400')}
                    ${createSection('Phone Numbers', phoneNumbers, phoneIcon, 'text-slate-400')}
                    ${createSection('WhatsApp Numbers', whatsappNumbers, whatsappIcon, 'text-green-500')}
                    ${createSection('Locations / Cities', locations, locationIcon, 'text-yellow-500')}
                </div>
                ${hasData ? aiButton : ''}
                <div class="ai-profile-container"></div>
            `;
        }

        resultCard.innerHTML = cardHeader + cardBody;
        resultsDiv.appendChild(resultCard);

        const aiBtn = resultCard.querySelector('.ai-profile-btn');
        if(aiBtn) {
            const allContacts = [...emails, ...phoneNumbers, ...whatsappNumbers];
            aiBtn.addEventListener('click', (e) => getAiProfile(textContent, allContacts, e.currentTarget));
        }
    }

    function handleExport() {
        if (allResultsData.length === 0) {
            displayMessage('No data to export.', 'yellow');
            return;
        }

        const headers = ['Name', 'URL', 'Emails', 'Phone Numbers', 'WhatsApp Numbers', 'Locations', 'Error'];
        const escapeCsvCell = (cellData) => `"${(cellData || '').toString().replace(/"/g, '""')}"`;
        const rows = allResultsData.map(result => [
            escapeCsvCell(result.name),
            escapeCsvCell(result.url),
            escapeCsvCell(result.emails.join('; ')),
            escapeCsvCell(result.phoneNumbers.join('; ')),
            escapeCsvCell(result.whatsappNumbers.join('; ')),
            escapeCsvCell(result.locations.join('; ')),
            escapeCsvCell(result.error)
        ].join(','));

        const csvContent = [headers.join(','), ...rows].join('\r\n');
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", "extracted_data.csv");
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    function displayMessage(message, color) {
        const toast = document.createElement('div');
        const colorClasses = {
            red: 'bg-red-500',
            yellow: 'bg-yellow-500',
            green: 'bg-green-600'
        };
        toast.className = `fixed bottom-5 right-5 p-4 rounded-lg text-white shadow-lg transform transition-all duration-300 translate-y-20 opacity-0 ${colorClasses[color] || 'bg-slate-700'}`;
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(() => {
            toast.classList.remove('translate-y-20', 'opacity-0');
        }, 100);
        setTimeout(() => {
            toast.classList.add('translate-y-20', 'opacity-0');
            setTimeout(() => toast.remove(), 300);
        }, 5000);
    }

    function toggleLoading(isLoading) {
        extractBtn.disabled = isLoading;
        exportBtn.disabled = isLoading;
        if (isLoading) {
            btnText.classList.add('hidden');
            loadingSpinner.classList.remove('hidden');
            extractBtn.classList.add('cursor-not-allowed');
        } else {
            btnText.classList.remove('hidden');
            loadingSpinner.classList.add('hidden');
            extractBtn.classList.remove('cursor-not-allowed');
        }
    }

    function clearResults() {
        resultsDiv.innerHTML = '';
        emptyStateDiv.classList.remove('hidden');
    }
</script>
</body>
</html>